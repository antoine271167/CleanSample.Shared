parameters:
- name: buildProjectFile
  type: string
- name: publishProjectFiles
  type: string
- name: projectFileName 
  type: string 
- name: setHubName
  type: boolean
  default: false
- name: hostJsonPath
  type: string
  default: ""
- name: hubNamePrefix
  type: string
  default: ""

jobs:
- job: Publish
  displayName: Publish
  steps:
  - ${{ if eq(parameters.setHubName, true) }}:
    - template: ../task/functionapp-set-hubname-task.yml
      parameters:
        hostJsonPath: ${{parameters.hostJsonPath}}
        hubNamePrefix: ${{parameters.hubNamePrefix}}
  - template: ../task/dotnet-restore-config-task.yml
  - template: ../task/dotnet-build-projects-task.yml
    parameters:
      projects: ${{parameters.buildProjectFile}}
  - template: ../task/dotnet-publish-projects-task.yml
    parameters:
      projects: ${{parameters.publishProjectFiles}}
  - template: ../task/publish-pipeline-artifact-task.yml    
    parameters:
      targetPath: $(Build.ArtifactStagingDirectory)/${{parameters.projectFileName}}