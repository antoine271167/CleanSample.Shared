parameters:
- name: azureSubscription
  type: string
- name: storageAccountName
  type: string
- name: resourceGroupName 
  type: string
    
steps:
- task: AzureCLI@2
  displayName: Get ConnectionString
  inputs:
    azureSubscription: ${{parameters.azureSubscription}}
    scriptType: bash
    scriptLocation: inlineScript
    inlineScript: |
      #!/bin/bash
      CONNECTIONSTRING=$(az storage account show-connection-string --name ${{parameters.storageAccountName}} --resource-group ${{parameters.resourceGroupName}} --query connectionString --output tsv)
      echo ${CONNECTIONSTRING}
      echo "##vso[task.setvariable variable=eventQueueStorageConnectionString;issecret=false]${CONNECTIONSTRING}"